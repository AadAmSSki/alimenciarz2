<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Karta Alimenciarza</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<style>
body{font-family:Arial;background:#111;text-align:center;margin:0;}
.card{width:360px;margin:20px auto;background:#d8c180;border-radius:18px;box-shadow:0 10px 20px rgba(0,0,0,0.6);padding:12px;color:black;}
.top{display:flex;}
.leftColumn{display:flex;flex-direction:column;align-items:center;margin-right:10px;}
.leftColumn img{width:100px;height:120px;object-fit:cover;border-radius:10px;border:2px solid #000;}
.flag{width:100px;height:60px;margin-top:8px;background:linear-gradient(to bottom, white 50%, red 50%);border:1px solid #000;border-radius:5px;}
.data{text-align:left;flex:1;}
.value{font-weight:bold;margin-bottom:2px;}
.label{font-size:12px;margin-bottom:6px;}
.buttons{display:flex;gap:6px;margin-top:10px;}
button{flex:1;padding:8px;border:none;border-radius:10px;background:#333;color:white;font-weight:bold;cursor:pointer;}
#moreData,#messages{display:none;background:white;padding:8px;border-radius:8px;margin-top:8px;max-height:140px;overflow:auto;}
.bottomBar{margin-top:10px;background:black;color:limegreen;padding:7px;border-radius:0 0 18px 18px;font-weight:bold;}
#generator input{margin:4px;padding:6px;width:90%;}
</style>
</head>
<body>

<h2 style="color:white;">KARTA ALIMENCIARZA</h2>

<div id="generator">
<input type="file" id="photoFile"><br>
<input type="text" id="photoURL" placeholder="Link do zdjęcia (do linku)"><br>

<input type="text" id="name" placeholder="Imię i nazwisko"><br>
<input type="text" id="dob" placeholder="Data urodzenia"><br>
<input type="text" id="citizenship" placeholder="Obywatelstwo"><br>
<input type="text" id="rejon" placeholder="Rejon"><br>
<input type="text" id="pesel" placeholder="PESEL"><br>
<input type="text" id="phone" placeholder="Nr telefonu"><br>
<input type="text" id="kod" placeholder="Kod"><br>
<input type="text" id="alimentRachunek" placeholder="Rachunek alimentacyjny"><br>
<input type="number" id="alimentKwota" placeholder="Kwota alimentów"><br>

<input type="number" id="children" placeholder="Ilość dzieci"><br>
<input type="number" id="mothers" placeholder="Ilość zaliczonych matek"><br>
<input type="number" id="ftmoInterventions" placeholder="Ilość interwencji FTMO"><br>
<input type="number" id="grandmaRent" placeholder="Ilość zajebania renty babki"><br>

<button onclick="randomData()">Losowe dane</button>
<button onclick="generate()">Generuj kartę</button>
<button onclick="copyLink()">Kopiuj link karty</button>
</div>

<div id="card" class="card" style="display:none;">
<div class="top">
<div class="leftColumn">
<img id="cardPhoto">
<div class="flag"></div>
<div id="qrCode"></div>
</div>
<div class="data">
<div class="value" id="cardName"></div><div class="label">imię i nazwisko</div>
<div class="value" id="cardPesel"></div><div class="label">pesel</div>
<div class="value" id="cardPhone"></div><div class="label">nr telefonu</div>
<div class="value" id="cardDOB"></div><div class="label">data urodzenia</div>
<div class="value" id="cardCitizenship"></div><div class="label">obywatelstwo</div>
<div class="value" id="cardRejon"></div><div class="label">rejon</div>
<div class="value" id="cardKwota"></div><div class="label">kwota alimentów</div>
</div>
</div>

<div class="buttons">
<button onclick="toggleMore()">Więcej danych</button>
<button onclick="toggleMsg()">Prywatne wiadomości</button>
</div>

<div id="moreData"></div>
<div id="messages"><div id="chat"></div></div>

<div class="bottomBar">✅ Dokument aktywny</div>
</div>

<script>
function q(id){return document.getElementById(id);}
let previewPhoto="";

q('photoFile').addEventListener('change',function(){
const file=this.files[0];
if(file){
const reader=new FileReader();
reader.onload=e=>previewPhoto=e.target.result;
reader.readAsDataURL(file);
}
});

function randomData(){
q('name').value="Jan Kowalski";
q('dob').value="1997-04-12";
q('citizenship').value="Polskie";
q('rejon').value="Rejon AB";
q('pesel').value=Math.floor(Math.random()*1e11);
q('phone').value=Math.floor(Math.random()*1e9);
q('kod').value="ABC-"+Math.floor(Math.random()*999);
q('alimentRachunek').value=Math.floor(Math.random()*1e26);
q('alimentKwota').value=1000+Math.floor(Math.random()*4000);
q('children').value=Math.floor(Math.random()*6);
q('mothers').value=Math.floor(Math.random()*12);
q('ftmoInterventions').value=Math.floor(Math.random()*20);
q('grandmaRent').value=Math.floor(Math.random()*5);
}

function buildData(){
return {
photo:q('photoURL').value,
name:q('name').value,
pesel:q('pesel').value,
phone:q('phone').value,
dob:q('dob').value,
citizenship:q('citizenship').value,
rejon:q('rejon').value,
kod:q('kod').value,
alimentRachunek:q('alimentRachunek').value,
alimentKwota:q('alimentKwota').value,
children:q('children').value,
mothers:q('mothers').value,
ftmoInterventions:q('ftmoInterventions').value,
grandmaRent:q('grandmaRent').value
};
}

function generate(){ showCard(buildData()); }

function showCard(d){
generator.style.display="none";
card.style.display="block";

cardPhoto.src = previewPhoto || d.photo || "";
cardName.innerText=d.name;
cardPesel.innerText=d.pesel;
cardPhone.innerText=d.phone;
cardDOB.innerText=d.dob;
cardCitizenship.innerText=d.citizenship;
cardRejon.innerText=d.rejon;
cardKwota.innerText=d.alimentKwota+" zł";

qrCode.innerHTML="";
new QRCode(qrCode,{text:d.kod,width:70,height:70});

window.currentData=d;
}

function toggleMore(){
moreData.style.display=moreData.style.display==="none"?"block":"none";
const d=window.currentData;
moreData.innerHTML=
"Kod: "+d.kod+
"<br>Rachunek alimentacyjny: "+d.alimentRachunek+
"<br>Ilość dzieci: "+d.children+
"<br>Ilość zaliczonych matek: "+d.mothers+
"<br>Ilość interwencji FTMO: "+d.ftmoInterventions+
"<br>Ilość zajebania renty babki: "+d.grandmaRent;
}

function toggleMsg(){
messages.style.display=messages.style.display==="none"?"block":"none";
if(messages.style.display==="block"){
setInterval(()=>{
const p=document.createElement("p");
p.innerHTML="<b>FTMO:</b> Nie opłaciłeś alimentów cwelu";
chat.appendChild(p);
},2500);
}
}

function copyLink(){
const d=buildData();
const encoded=btoa(unescape(encodeURIComponent(JSON.stringify(d))));
const url=location.origin+location.pathname+"?d="+encoded;
navigator.clipboard.writeText(url);
alert("Link karty skopiowany!");
}

window.onload=function(){
const p=new URLSearchParams(location.search).get("d");
if(p){showCard(JSON.parse(decodeURIComponent(escape(atob(p)))));}
}
</script>
</body>
</html>
